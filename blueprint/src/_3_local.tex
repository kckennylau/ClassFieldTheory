\chapter{Local Class Field Theory}

In this chapter we shall consider finite Galois extensions of non-archimedean local fields $l/k$.
We shall regard the multiplicative group $l^\times$
as a representation of $\Gal(l/k)$ over the ring $\Z$, where
addition in the module is the operation which is usually written as multiplication.
We shall always write $H^\bullet(l/k,-)$ as an abbreviation of $H^\bullet(\Gal(l/k),-)$.
By the fundamental theorem of Galois theory we have
\[
	H^0(l/k,l^\times) = (l^\times)^G = l^\times.
\]
The norm map $N_{\Gal(l/k)} : l^\times \to l^\times$ defined in \ref{def:norm}
takes values in $k^\times$ and coincides with the usual norm map $N : l^\times \to k^\times$. This implies by
\ref{lem:Tate cohomology is cohomology or homology} the isomorphism
\[
	H^0_{\Tate}(l/k,l^\times) \cong k^\times / N(l^\times).
\]
We shall prove that $(\Z,\Gal(l/k),l^\times)$ is a finite class formation and we shall construct a
fundamental class $\sigma \in H^2(l/k, l^\times)$.
This fundamental class gives a reciprocity isomorphism
\[
	\Gal(l/k)^{\ab}
	\cong
	k^\times / N(l^\times), \qquad
	g \mapsto \prod_{x \in \Gal(l/k)} \sigma'(x,g).
\]
In the case that $l/k$ is unramified, the Galois group is generated by a Frobenius element $F_k$,
and the reciprocity map satisfies (for any uniformizer $\pi_k$ in $k$)
\[
	\reciprocity(F_k) = \pi_k N(l^\times).
\]
The construction of this reciprocity isomorphism and its properties are known as
\emph{local class field theory}.

Recall that $(\Z,\Gal(l/k),l^\times)$ is a finite class formation if for every subgroup
$S \le \Gal(l/k)$ we have isomorphisms:
\[
	H^1(S,l^\times) \cong 0, \qquad H^2(S,l^\times) \cong \Z / |S| \Z.
\]
A more convenient to reformulation of this condition is the following.
For all intermediate fields $l / m / k$ we have isomorphisms:
\[
	H^1(l/m,l^\times) \cong 0, \qquad H^2(l/m,l^\times) \cong \Z / [l:m] \Z.
\]
The reason why this reformulation is so useful is because the base field $k$ is no longer involved,
so it's sufficient to prove the isomorphisms above for any finite Galois extension of local fields $l/m$
(i.e. without considering any subgroups of the Galois group).

The proof that $l^\times$ is a class formation is achieved in the following steps:
\begin{enumerate}
	\item
	It is already proven in Mathlib that $H^1(l/k,l^\times) \cong 0$;
	this result is known as Hilbert's theorem 90.
	It remains to check that each $H^2(l/k,l^\times)$ is cyclic of order $[l:k]$, and to
	choose a generator.
	\item
	In the case that $\Gal(l/k)$ is cyclic, we can show that $|H^2(l/k,l^\times)| = [l:k]$ by
	Herbrand quotients. By inflation-restriction, this implies $|H^2(l/k,l^\times)| \le [l:k]$
	for all Galois extensions. Hence to prove that $l^\times$ is a class formation it's sufficient to
	find an element in $H^2(l/k,l^\times)$ of order $[l:k]$; such an element is a fundamental class.
	\item
	Suppose $l/k$ is unramified. In this case we have a decomposition:
	\[
		l ^\times \cong \cO_l^\times \oplus \Z.
	\]
	The subrepresentation $\cO_l^\times$ has trivial cohomology in this unramified case.
	Therefore for any intermediate field $l/m/k$ we have
	$H^\bullet(l/m,l^\times) \cong H^\bullet(l/m,\Z)$.
	Since $\Z$ is a finite class formation over a cycic group, it follows that $l^\times$ is a
	finite class formation.
	The cocycle $\sigma_1$ defined in \ref{lem:H2 cyclic Z} is a fundamental class,
	where we use the Frobenius element as a generator.
	\item
	Suppose $l/k$ is a Galois extension which is not necessarily unramified. To define the
	fundamental class in this case, we let $l'/k$ be the unramified extension with the same degree as
	$l/k$. We have already constructed the fundamental class $\sigma_1 \in H^2(l'/k, l'^\times)$.
	We let $\sigma_2$ be the inflation of $\sigma_1$ to $H^2(ll'/k, (ll')^\times)$.
	The extension $ll' / l$ is unramified, so we already have an explicit isomorphism
	$H^2(ll'/l, (ll')^\times) \cong \Z / [ll':l]$.
	Using this isomorphism, we can show that the restriction of $\sigma_2$
	to $H^2(ll'/l, (ll')^\times)$ is zero.
	Hence by inflation-restriction there exists a unique $\sigma \in H^2(l/k, l^\times)$ whose
	inflation is $\sigma_2$.
	It is then easy to check that $\sigma$ is a fundamental class in $H^2(l/k,l^\times)$.
\end{enumerate}





\section{Notation and Preliminary results}

The following result (called Hilbert's theorem 90) is already in Mathlib.

\begin{theorem}\label{thm:hilbert 90}
	\mathlibok
	Let $l/k$ be a finite Galois extension of fields.
	Then $H^1(l/k, l^\times) \cong 0$.
\end{theorem}

\begin{proof}
	\mathlibok
	This is already in Mathlib.
\end{proof}

\begin{theorem}\label{thm:additive field trivial}
	\uses{lem:induced trivial Tate}
	Let $l/k$ be a finite Galois extension of fields.
	Then there is an isomorphism of $\Gal(l/k)$-representations:
	\[
		l \cong \ind_1(k).
	\]
	In particular $l$ has trivial Tate cohomology as a representation of $\Gal(l/k)$.
\end{theorem}

\begin{proof}
	Recall from Galois theory that there is a normal basis for $l$ over $k$, i.e. a basis of the
	form
	\[
		\{x \bullet b_0 : x \in \Gal(l/k)\}.
	\]
	Define a map $\ind_1(k) \cong l$ by
	\[
		\Phi (f : G \to_0 k) = \sum_{x \in \Gal(l/k)} f(x) \cdot x^{-1} \bullet b_0.
	\]
	The map $\Phi$ is clearly a linear bijection;
	we check that it commutes with the Galois action:
	\[
		\Phi(g\bullet f)
		= \sum_x f(xg) \cdot x^{-1} \bullet b_0
		= \sum_x f(x) \cdot (xg^{-1})^{-1} \bullet b_0
		= g \bullet \Phi(f).
	\]
\end{proof}






\section{The Herbrand quotient of \texorpdfstring{$l^{\times}$}{l*}}

In this section we'll prove that for a cyclic extension $l/k$ of local fields,
$h(l/k,l^\times) = [l:k]$.

\begin{lemma}
	\label{lem:exists additive trivial}
	\uses{lem:induced trivial Tate}
	Let $l/k$ be a Galois extension of local fields and
	let $U$ be any neighbourhood of $0$ in $l$.
	There is a Galois-invariant compact open subgroup $L \subseteq U$
	which has trivial Tate cohomology.
\end{lemma}

\begin{proof}
	Let $P$ be the maximal ideal of $\cO_l$.
	Choose $n$ such that $P^n \subseteq U$.
	Choose a normal basis for $l$ over $k$ contained in $P^n$
	and let $L$ be the span of that basis over $\cO_k$.
	We therefore have an isomorphism of Galois modules $L \cong \ind_1(\cO_k)$,
	and induced representations have trivial Tate cohomology.
\end{proof}

\begin{lemma} \label{lem:herbrand compact open additive}
	\uses{def:herbrand quotient,
		lem:exists additive trivial,
		lem:herbrand finite,
		lem:herbrand ses}
	Suppose $l/k$ is a cyclic extension.
	Let $M \subset l$ be a compact open subrepresentation.
	Then $h(l/k,M)=1$.
\end{lemma}

\begin{proof}
	Choose $L \subseteq M$ as in lemma \ref{lem:exists additive trivial}.
	Since $L$ has finite index in $M$ we have $h(M) = h(L) = 1$.
\end{proof}


\begin{lemma}\label{lem:local isomorphism}
	For $n \in \N$ sufficiently large, the
	exponential map gives an isomorphism
	\[
		(P^n,+) \cong (1 + P^n, \times).
	\]
	This isomorphism commutes with the action of the Galois group, so is an
	isomorphism of representations.
\end{lemma}

\begin{proof}
	Choose $n$ large enough so that $\exp(x)$ converges for all $x \in P^n$,
	and such that all the terms $x^r/r!$ are in $P^n$ for $r \ge 1$
	and all the terms $x^r / r!$ with $r \ge 2$ have strictly larger valuation than that of $x$.
	It is already proved in Mathlib that $\exp(x+y)=\exp(x)\exp(y)$, and the fact that $\exp$ commutes
	with the Galois action is straightforward.
	We'll show that the map is a bijection from $P^n$ to $1+P^n$.

	Suppose $\exp(x)=1$ with $x \in P^n$.
	If $x \ne 0$ then $x = \pi^mu$ for some unit $u$.
	By assumption on $n$, $\exp(x) = 1 + \pi^m u + O(\pi^{m+1})$; this gives a contradcition.
	Therefore the map $\exp : P^n \to 1+P^n$ is injective.

	One can show that the map $P^n \to 1+P^n$ is surjective using Hensel's lemma as follows.
	Choose $y \in 1+P^n$. Then $x_0 = y-1$ is in $P^n$ and $\exp(x) \equiv y \bmod P^{n+1}$.
	Furthermore $\exp'(x_0) = \exp(x_0) \not\equiv 0 \bmod P$. Hensel's lemma shows that there exists
	a solution to $\exp(x)=y$ with $x \equiv x_0 \bmod P^{n+1}$.
	In particular $x \in P^n$.
\end{proof}


\begin{lemma}\label{lem:herbrand local units}
	\uses{lem:local isomorphism,
		lem:herbrand compact open additive,
		lem:herbrand finite,
		lem:herbrand ses}
	If $l/k$ is a cyclic extension, then $h(l/k, \cO_l^\times) = 1$.
\end{lemma}

\begin{proof}
	Choose a subgroup $1+P^n$ as in the \ref{lem:local isomorphism}.
	Since $\cO_l^\times / (1+P^n)$ is finite we have
	(using \ref{lem:herbrand finite} and \ref{lem:herbrand ses})
	\[
		h(\cO_l^\times) = h(1+P^n) = h(P^n).
	\]
	The right hand side is $1$ by \ref{lem:herbrand compact open additive}.
\end{proof}

\begin{lemma} \label{lem:herbrand local l*}
	\uses{lem:herbrand local units,
		eg:herbrand Z,
		lem:herbrand ses}
	If $l/k$ is a cyclic extension of local fields then $h(l/k, l^\times)= [l:k]$.
\end{lemma}

\begin{proof}
	We have a short exact sequence of representations
	\[
		0 \to \cO_l^\times \to l^\times \to \Z \to 0,
 	\]
	where the second map is the valuation.
	We've shown in \ref{lem:herbrand local units}, \ref{eg:herbrand Z}
	that $h(l/k,\cO^\times)=1$ and $h(l/k,\Z) = [l:k]$.
	Therefore $h(l/k,l^\times) = [l:k]$.
\end{proof}


\begin{lemma} \label{lem:local H2 l*}
	\uses{lem:herbrand local l*,
		thm:hilbert 90}
	If $l/k$ is a cyclic extension of local fields then $|H^2(l/k,l^\times)| = [l:k]$.
\end{lemma}

\begin{proof}
	The follows from \ref{lem:herbrand local l*} and \ref{thm:hilbert 90}.
\end{proof}




\section{An upper bound for \texorpdfstring{$H^2(l/k,l^\times)$}{$H^2(l/k,l*)$}}

\begin{theorem} \label{lem:local H2 upper bound}
	\uses{thm:hilbert 90,
		thm:inflation restriction sequence,
		lem:local H2 l*,
		cor:cohomology G-torsion,
		cor:cohomology sub Sylow,
		lem:Hn unit}
	Let $l/k$ be a Galois extenion of local fields.
	Then $|H^2(l/k,l^\times)| \le [l:k]$.
\end{theorem}

\begin{proof}
	Let $p$ be prime number dividing the degree $[l:k]$ and let $k_p$ be the fixed field
	of a Sylow $p$-subgroup $S_p$ of $\Gal(l/k)$.
	By \ref{cor:cohomology G-torsion} and \ref{cor:cohomology sub Sylow}
	it is sufficient to prove that $|H^2(l/k_p,l^\times)| \le [l:k_p]$,
	which is a special case of the theorem.
	In the special case, the Galois group is $S_p$, which is a solvable group.
	It is therefore sufficient to prove the theorem in the case that $\Gal(l/k)$ is solvable.
	(Note that $\Gal(l/k)$ is always solvable if $l/k$ is an extension of local fields,
	but we do not need to prve this.)

	We shall prove the theorem by induction on $k$, starting with $k=l$ and moving down in
	cyclic steps.
	The case $k=l$ follows by \ref{lem:Hn unit}.
	Assume the result for $l/k$ and let $k_0$ be a subfield of $k$ with $k/k_0$ cyclic.
	It follows from \ref{thm:hilbert 90} that
	we have an inflation-restriction sequence in dimension 2:
	\[
		0 \to H^2(k/k_0, k^\times) \to H^2( l/k_0, l^\times) \to H^2(l/k, l^\times).
	\]
	The first term has order $[k : k_0]$ by \ref{lem:local H2 l*}, and the last term has
	order at most $[l:k]$ by the inductive hypothesis.
	Thereofore $H^2( l/k_0, l^\times)$ has order at most $[l:k] \times [k : k_0] = [l: k_0]$.
\end{proof}







\section{Fundamental classes in unramified extensions}

In this section we assume that $l/k$ is unramified.
In this case $\Gal(l/k)$ may be identified with $\Gal(\F_l / \F_k)$ where
$\F_l$ and $\F_k$ are the residue class fields of $l$ and $k$ respectively.
This group is cyclic and is generated by the Frobenius element $F_k$.
If we choose a uniformizer $\pi_k$ in $k$ (i.e. a generator for the maximal ideal in $\cO_k$)
then $\pi_k$ is also a uniformizer in $l$, so we may identify $\F_l$ with $\cO_l / \pi_k \cO_l$.

\begin{lemma} \label{lem:finite field trivial}
	\uses{thm:additive field trivial,
		cor:periodic cohomology,
		lem:herbrand finite,
		thm:hilbert 90}
	The Galois modules $\F_l$ and $\F_l^\times$ have trivial cohomology.
\end{lemma}

\begin{proof}
	In the case of $l$, this follows from \ref{thm:additive field trivial} as $\Gal(l/k)$ may be
	identified with $\Gal(\F_l / \F_k)$, so we focus on the
	representation $l^\times$. Given any subgroup $S$ of the Galois group we must prove that
	$H^\bullet_{\Tate}(l/m,l^\times) \cong 0$, where $m$ is the fixed field of $S$.

	Note that $l/m$ is also unramified, so has cyclic Galois group.
	By \ref{cor:periodic cohomology},
	it's suffient to prove that $H^1(l/m,l^\times)$ and $H^2(l/m,l^\times)$ are trivial.
	By \ref{lem:herbrand finite} the representation $\F_l^\times$ has Herbrand quotient $1$,
	so it's enough to prove that $H^1$ is trivial.
	This follows from \ref{thm:hilbert 90}.
\end{proof}


\begin{lemma} \label{lem:unramified additive trivial}
	\uses{thm:additive field trivial}
	If $l/k$ is unramified then there is a normal basis for $\cO_l$ over $\cO_k$.
	Hence there is an isomorphism of Galois representations $\cO_l \cong \ind_1 \cO_k$.
	In particular $\cO_l$ has trivial cohomology.
\end{lemma}

\begin{proof}
	By \ref{thm:additive field trivial}
	we may choose $x_0 \in \F_l$
	such that $\{g \bullet x_0 :g \in \Gal(l/k)\}$ is a normal basis.
	Let $y \in \cO_l$ be a lift of $x_0$.
	It follows from Nakayama's lemma that $\{g \bullet y\}$ is a normal basis	in $\cO_l$.
	As in earlier proofs, this implies the isomorphism $\cO_l \cong \ind_1 \cO_k$.
\end{proof}




\begin{lemma}	\label{lem:unramified units trivial}
	\uses{lem:local isomorphism,
		lem:unramified additive trivial,
		lem:finite field trivial}
	If $l/k$ is unramified then $\cO_l^\times$ has trivial cohomology.
\end{lemma}

\begin{proof}
	Recall (\ref{lem:local isomorphism}) that for $n$ sufficiently large we have isomorphisms of
	Galois modules:
	\[
		1 + P^n \cong P^n \cong \cO_l,
	\]
	where the first map is the logarithm and the second map is multiplication by $\pi_k^{-n}$.
	Hence by \ref{lem:unramified additive trivial}, the multiplictive subgroup $1+P^n$ has trivial
	cohomology.
	The long exact sequence now gives isomorphisms
	\[
		H^r(l/k,\cO_l^\times) \cong H^r(l/k,\cO_l^\times / (1+P^n)).
	\]
	We'll prove by induction on $n$ that $\cO_l^\times / (1+P^n)$ has trivial cohomology.
	In the case $n = 1$ we have
	\[
		\cO_l^\times / (1+P) \cong \F_l^\times.
	\]
	In this case the result follows from \ref{lem:finite field trivial}.

	For the inductive step we note that there is a short exact sequence of Galois modules
	\[
		0 \to \F_l \to  \cO_l^\times / (1+P^{n+1})  \to\cO_l^\times / (1+P^n)  \to  0,
	\]
	where we have identified $P^n / P^{n+1}$ with $\F_l$.
	By the inductive hypothesis, we assume that $\cO_l^\times / (1+P^n)$ has tivial cohomology.
	By \ref{lem:finite field trivial} $\F_l$ has trivial cohomology.
	Hence by the long exact seqeunce, $\cO_l^\times / (1+P^{n+1})$ has trivial cohomology.
\end{proof}


\begin{corollary} \label{cor:cohomology unramified iso cohomology Z}
	\uses{lem:unramified units trivial}
	Let $l/k$ be an unramified extension of local fields.
	Then there are isomorphisms
	\[
		H^\bullet_{\Tate}(l/k,l^\times) \cong H^\bullet_{\Tate} (l/k,\Z)
	\]
	defined by the valuation map $v : l^\times \to \Z$.
	The inverse map is defined by $n \mapsto \pi_k^n$, and does not depend on the choice of $\pi_k$.
\end{corollary}

\begin{proof}
	This follows from the long exact sequence using \ref{lem:unramified units trivial}.
\end{proof}


\begin{lemma} \label{lem:unramified fundamental class}
	\uses{cor:cohomology unramified iso cohomology Z,
		lem:H2 cyclic Z}
	Let $l/k$ be an unramified cyclic extension of local fields.
	Then $H^2(l/k,l^\times)$ is cyclic of order $[l:k]$.
	It is generated by the cohomology class of the following 2-cocycle
	\[
		\sigma_{l/k} (F_k^r, F_k^s) =
		\begin{cases}
			1 & r + s < [l:k], \\
			\pi_k & r + s \ge [l:k].
		\end{cases}
	\]
	Here $F_k$ is the Frobenius element generating $\Gal(l/k)$ and $r$ and $s$
	are chosen to be integers in the range $0 \le r,s <[l:k]$.
	It follows that $l / k$ is a finite class formation and $\sigma_{l/k}$ is a fundamental class.
\end{lemma}

\begin{proof}
	This follows from \ref{cor:cohomology unramified iso cohomology Z}
	together with the description of $H^2(l/k,\Z)$ in \ref{lem:H2 cyclic Z}.
\end{proof}

We therefore have a reciprocity isomorphism $\Gal(l/k) \cong k^\times / N(l^\times)$.

\begin{lemma} \label{lem:local unramified reciprocity}
	\uses{lem:unramified fundamental class,
		lem:reciprocity formula}
	Let $l/k$ be a finite unramified extension of local fields and let $F_k$ be the Frobenius
	element in $\Gal(l/k)$. Let $\pi_k$ be a uniformizer of $k$. Then we have
	\[
		\reciprocity (F_k)= \pi_k,
	\]
	where the reciprocity map is defined by the fundamental class $\sigma_{l/k}$.
\end{lemma}

\begin{proof}
	This follows from \ref{lem:reciprocity formula} and \ref{lem:unramified fundamental class}.
\end{proof}


\begin{definition} \label{def:local inv}
	\uses{lem:H2 cyclic Z}
	By \ref{lem:H2 cyclic Z} we have an isomorphim $H^2(l/k, l^\times) \cong \frac{1}{[l:k]}\Z / \Z$
	defined by
	\[
		\inv_{l/k}(\sigma) = \frac{1}{[l:k]} \sum_{i=0}^{[l:k]-1} v_k(\sigma(F_k^i, F_k)).
	\]
	The map $\inv_{l/k}$ is called the \emph{local invariant}.
\end{definition}

\begin{lemma} \label{lem:local inv fundamental class}
	\uses{lem:unramified fundamental class,
		def:local inv}
	The fundamental class $\sigma_{l/k}$ has local invariant $\frac{1}{[l:k]}$.
\end{lemma}

\begin{proof}
	It follows from the definitions that all the terms in the sum defining the local invariant are zero
	apart from the term $i=[l:k]-1$, so we have
	\[
		\inv_{l/k}(\sigma_{l/k})
		= \frac{1}{[l:k]} v_k(\sigma(F_k^{[l:k]-1}, F_k)).
		= \frac{1}{[l:k]} v_k(\pi_k)
		= \frac{1}{[l:k]}.
	\]
\end{proof}


\begin{lemma} \label{lem:local unram rest}
	\uses{lem:unramified fundamental class}
	Let $m / l / k$ be an unramified tower of extensions of local fields
	Then the restriction to $m/l$ of $\sigma_{m/k}$ is $\sigma_{m/l}$.
\end{lemma}

\begin{proof}
	Up to cohomology, $\sigma_{l/k}$ does not depend on the choice of
	uniformizer, so we may assume $\pi_k=\pi_l$
	in our definitions of $\sigma_{m/k}$ and $\sigma_{m/l}$.
	We have $F_l = F_k^f$ where $f = [l:k]$.
	Hence
	\begin{align*}
		\sigma_{m/k}(F_l^r, F_l^s)
		&=
		\sigma_{m/k}(F_k^{fr}, F_k^{fs})\\
		&=
		\begin{cases}
			1 & fr + rs < [m:k] \\
			\pi_k & fr + fs \ge [m:k]
		\end{cases}\\
		&=
		\begin{cases}
			1 & r + s < [m:l] \\
			\pi_k & r + s \ge [m:l]
		\end{cases}\\
		&=\sigma_{m/l}(F_l^r,F_l^s).
	\end{align*}
\end{proof}



\begin{lemma} \label{lem:local unram inv infl}
	\uses{def:local inv,
		lem:local inv fundamental class}
	Let $m / l / k$ be a tower of unramified extensions of local fields
	and let $\infl : H^2(l/k,l^\times) \to H^2(m/k,m^\times)$ be the inflation map.
	Then
	\[
		\inv_{m/k} \circ \infl  = \inv_{l/k}.
	\]
	In particular $\infl(\sigma_{l/k}) = [m:l]\cdot \sigma_{m/k}$.
\end{lemma}

\begin{proof}
	We shall write $F_{m/k}$ and $F_{l/k}$ for the Frobenius elements in $\Gal(m/k)$ and
	$\Gal(l/k)$ respectively. Note that $F_{l/k}$ is the restriction of $F_{m/k}$ to $l$,
	so is the coset of $F_{m/k}$ when we regard $\Gal(l/k)$ as a quotient of $\Gal(m/k)$.
	From the definition we have (for any $\sigma \in H^2(l/k,l^\times)$):
	\[
		\inv_{m/k}(\infl(\sigma))
		= \frac{1}{[m:k]}\sum_{i=0}^{[m:k]-1} v_k(\sigma(F_{l/k}^i,F_{l/k})).
	\]
	The terms in the sum are periodic since $F_{l/k}^{[l:k]}=1$.
	This implies (by the tower law):
	\[
		\inv_{m/k}(\infl(\sigma))
		= \frac{1}{[m:k]} [m:l]\sum_{i=0}^{[l:k]-1} v_k(\sigma(F_{l/k}^i,F_{l/k})).
	\]
	The right hand side is equal to $\inv_{l/k}(\sigma)$.
	The formual $\infl(\sigma_{l/k}) = [m:l]\cdot \sigma_{m/k}$ follows since both sides of the
	equation have local invariant equal to $\frac{1}{[l:k]}$
	(by \ref{lem:local inv fundamental class}).
\end{proof}






\section{Construction of fundamental classes}

Now let $l/k$ be a Galois extension of local fields of degree $n$ and let $l'$ be
the unramified extension of the same degree.
We shall let $m$ be the field generated by $l$ and $l'$.
Let $e$ and $f$ be the ramification index and inertia degree of $l/k$.
Then we have $[m:l] = e$, $v_l(\pi_k)= e$.
We shall write $F_{m/l}$ for the Frobenius element in $\Gal(m/l)$, which we regard as a subgroup
of $\Gal(m/k)$. We also write $F_{l'/k}$ for the Frobenius element in $\Gal(l'/k)$.
With this notation we have:
\[
	F_{m/l}|l' = F_{l'/k}^f.
\]
In \ref{lem:unramified fundamental class} we have a constructed fundamental class
$\sigma_{l'/k} \in H^2(l'/k,l'^\times)$.
Let $\psi\in H^2(m/k,m^\times)$ be the inflation of $\sigma_{l'/k}$.
By \ref{thm:hilbert 90} the inflation map is injective,
so $\psi$ has order exactly $[l':k] = [l:k]$.
We also have an inflation restriction sequence
\[
	0 \to H^2(l/k, l^\times) \to H^2(m/k , m^\times) \to H^2(m/l, m^\times)
\]
We'll calculate the restriction of $\psi$ to $H^2(m/l, m^\times)$.
Since $m/l$ is unramified, we have an isomorphism
\[
	\inv_{m/l} : H^2(m/l, m^\times) \cong \frac{1}{e}\Z/ \Z.
\]
We have
\begin{align*}
	\inv_{m/l}(\psi)
	&=\frac{1}{e} \sum_{i=0}^{e-1} v_l (\psi (F_l^i,F_l))\\
	&=\frac{1}{e} \sum_{i=0}^{e-1} v_l (\sigma_{l'/k}((F_l|l')^i,F_l|l'))\\
	&=\frac{1}{e} \sum_{i=0}^{e-1} v_l (\sigma_{l'/k}(F_k^{if},F_k^f))\\
	&=\frac{1}{e} v_l (\pi_k) = 1 \equiv 0 \bmod \Z.
\end{align*}
The first line above is the definition of $\inv_{m/l}$.
The second line is the definition of inflation of cocycles.
The calculation above shows that the image of $\psi$ in $H^2(m/l, m^\times)$ is $0$.
Therefore $\psi$ is the inflation of a unique element $\sigma_{l/k} \in H^2(l/k,l^\times)$.
Since the inflation map is injective $\sigma_{l/k}$ also has order $[l:k]$.

\begin{theorem} \label{thm:local fund class}
	\uses{
		lem:unramified fundamental class,
		thm:hilbert 90,
		def:local inv,
		lem:local H2 upper bound
	}
	For every finite Galois extension $l/k$ of local fields, $(\Z,\Gal(l/k),l^\times)$ is a finite
	class formation. The element $\sigma_{l/k}$ defined above is a funcdamental class.
	Corresponding the $\sigma_{l/k}$ there is a reciprocity isomorphism
	\[
		\Gal(l/k) \cong k^\times / N(l^\times).
	\]
\end{theorem}

\begin{proof}
	From \ref{thm:hilbert 90} we know that $H^1(l/k,l^\times) \cong 0$.
	From \ref{lem:local H2 upper bound}, we know that $H^2(l/k,l^\times)$ has no more that $[l:k]$
	elements.
	We have constructed an element $\sigma_{l/k}\in H^2(l/k,l^\times)$ of order $[l:k]$, so
	$H^2(l/k,l^\times)$ is cyclic of order $[l:k]$ and is generated by $\sigma_{l/k}$.
\end{proof}




\section{Some consequences of the reciprocity isomorphism}

\begin{theorem} \label{thm:local norm limitation}
	\uses{cor:norm limitiation,
		thm:local fund class}
	Let $l/k$ be a finite Galois extension of local fields and let $l^{\ab}$ be the
	maximal subfield of $l$ which is an abelian extsion of $k$, i.e. the fixed field of
	the commutator subgroup of $\Gal(l/k)$.
	Then $N_{l/k}(l^\times) = N_{l^\ab/k}(l^{\ab\times})$.
\end{theorem}

\begin{proof}
	This follows from \ref{cor:norm limitiation} and \ref{thm:local fund class}.
\end{proof}



\begin{theorem} \label{lem:local abelian classification}
	\uses{thm:local fund class,
		cor:norm submodule mono}
	Let $l_1$ and $l_2$ be two abelian extensions of $k$ contained in a field $m$.
	Then $l_1 \subseteq l_2$ if and only if $N_{l_1/k}(l_1^\times) \supseteq N_{l_2/k}(l_2^\times)$
	and $l_1 = l_2$ if and only if $N_{l_1/k}(l_1^\times) = N_{l_2/k}(l_2^\times)$.
\end{theorem}

\begin{proof}
	This follows from \ref{cor:norm submodule mono}.
\end{proof}



\begin{lemma} \label{lem:norm composite intersection}
	\uses{thm:local fund class,
		lem:subgroup compatibility
	}
	Let $l/k$ be a finite abelian extension and let $m_1$ and $m_2$ be two intermediate
	fields between $k$ and $l$ such that $l = m_1 m_2$.
	Then we have
	\[
		N_{l/k}(l^\times) = N_{m_1/k} (m_1^\times) \cap N_{m_2/k} (m_2^\times).
	\]
\end{lemma}

\begin{proof}
	Clearly if $x \in N_{l/k}(l^\times)$ then $x$ is a norm from both $m_1$ and $m_2$.
	Suppose conversely that $x$ is a norm from both $m_1$ and $m_2$.
	Let $S_i=\Gal(l/m_i)$ for $i=1,2$.
	By the commutative diagram in \ref{lem:subgroup compatibility},
	the coset $xN(l^\times)$ is in the image of each $S_i$ under the reciprocity map.
	Since the reciprocity map is bijective, $xN(l^\times)$ is in the image of
	$S_1 \cap S_2$.
	The condition $l = m_1 m_2$ implies $S_1 \cap S_2 = 1$.
	Therefore $x \in N(l^\times)$.
\end{proof}



\begin{lemma} \label{lem:local unramified norms}
	\uses{lem:unramified fundamental class}
	Let $l/k$ be an unramified extension of local fields of degree $f$.
	Then $N(l^\times) = \pi_k^{f\Z} \times \cO_k^\times$.
\end{lemma}

\begin{proof}
	By \ref{lem:unramified units trivial} we have $H^0_{\Tate}(l/k,\cO_l^\times) \cong 0$,
	which implies that every element of $\cO_k^\times$ is a norm.
	The element $\pi_k^f$ is the norm of $\pi_k$.
	Therefore $\pi_k^{f\Z} \times \cO_k^\times \subseteq N(l^\times)$.
	To prove equality, we note that these subgroups of $k^\times$ have the same index.
	Indeed by \ref{lem:unramified fundamental class}, $k^\times / N(l^\times)$
	is isomorphic to $\Gal(l/k)^\ab$, which has order $f$.
\end{proof}


\begin{lemma} \label{lem:local image inertia}
	\uses{lem:subgroup compatibility,
		lem:local unramified norms}
	Let $l/k$ be a finite abelian extension of local fields and let $I \subseteq \Gal(l/k)$ be
	the inertia subgroup.
	Then the image of $I$ in $k^\times / N(l^\times)$
	is the subgroup $\cO_k^\times / N(\cO_l^\times)$.
\end{lemma}

\begin{proof}
	Let $m$ be the fixed field of $I$.
	By \ref{lem:subgroup compatibility} the image of $I$ in $k^\times / N(l^\times)$
	is $N_{m/k}(m^\times) / N_{l/k}(l^\times)$.
	Since $m/k$ is unramified, \ref{lem:local unramified norms} implies
	\[
		N_{m/k}(m^\times) = \cO_k^\times \times \pi_k^{f\Z},
	\]
	where $f$ is the inertial degree of $l/k$.
	If $\pi_l$ is a uniformizer in $l$ then $N(\pi_l)$ is a unit multiple of $\pi_k^f$.
	This implies
	\[
		N_{m/k}(m^\times) = \cO_k^\times \times N(\pi_l^{\Z}).
	\]
	The result follows from this.
\end{proof}


\begin{lemma} \label{lem:local cyclotomic norms}
	\uses{thm:local fund class,
		lem:local isomorphism}
	Let $l = \Q_p(\zeta)$ where $\zeta$ is a primitive $p^n$-th root of unity
	for some $n > 0$.
	Then $N(l^\times) = p^\Z \times (1+p^n \Z_p)$.
\end{lemma}

\begin{proof}
	By Eisenstein's criterion, the cyclotimic polynomial
	$\Phi_{p^n}(X) = \frac{X^{p^n}-1}{X^{p^{n-1}}-1}$ is irreducible over $\Q_p$.
	Hence the degree of the extension is $\phi(p^n)=p^n - p^{n-1}$.
	This coincides with the index:
	\begin{align*}
		[\Q_p^\times : p^\Z \times (1+p^n \Z_p)]
		&= [\Z_p^\times : (1+p^n \Z_p)] \\
		&= | (\Z / p^n \Z)^\times |.
	\end{align*}
	It it therefore sufficient to prove that every element of $p^\Z \times (1+p^n \Z_p)$
	is a norm.

	We have $p = N(1-\zeta)$.
	It is therefore sufficient to show that every $x \in 1 + p^n \Z_p$
	is the norm of an element of $\Z_p[\zeta]$. We split this into cases.
	\begin{itemize}
		\item
		Suppose $p$ is an odd prime, so that $\exp(pz)$ converges for all $z\in \Z_p$.
		If $a \in 1 +p^n\Z_p^\times$ then by \ref{lem:local isomorphism}
		there is an expression of $a$ of the form
		\[
			a = \exp(p^n y), \qquad y \in \Z_p.
		\]
		It follows that
		\[
			a= \exp(p\frac{y}{p-1}) ^{[\Q_p(\zeta):\Q_p]}
			= N_{\Q_p(\zeta)/\Q_p}(\exp(py/(p-1))).
		\]
		In particular, $x\in N(\Q_p(\zeta)^\times)$.
		\item
		In the case $p^n = 2$ we have $l = \Q_2$, so every element of $\Q_2$ is a norm.
		\item
		In the case $p=2$, $n \ge 2$, there is an intermediate field $l / \Q_2(i) / \Q_2$,
		and we have
		\[
			N_{\Q_p(i) / \Q_p} (x+i y) = x^2 + y^2.
		\]
		It's easy to show (for example using Hensel's lemma) that if $a \equiv 1 \bmod 4$
		then $a$ is the norm of an element of $\Q_p(i)$.
		If $a \in 1 + 2^n \Z_2$ then we have for some $b \in \Z_2$:
		\[
			a = \exp(2^n b) = \exp(4b)^{[l:\Q_2(i)]}.
		\]
		The the exponential above converges to an element of $1+4\Z_2$.
		In particular there is an element $b \in \Q_2(i)$ such that
		\[
			a = N_{\Q_2(i)/\Q_2} (b) ^ [l:\Q_2(i)]
			= N_{l/\Q_2} (b)
		\]
	\end{itemize}
\end{proof}

\begin{theorem} \label{thm:local Kronecker Weber}
	\uses{lem:local cyclotomic norms}
	Let $l/\Q_p$ be a finite abelian extension.
	Then $l$ is isomorphic to a subfield of a cyclotomic extension.
\end{theorem}

\begin{proof}
	The subgroup $N_{l/\Q_p}(l^\times)$ is open in $\Q_p^\times$, so it must contain
	a subgroup of the form $1+p^n\Z_p$ for some $n$.
	Let $f$ be the order of $p$ in $\Q_p^\times / N(l^\times)$.
	\[
		N(l^\times) \supset p^{f\Z} \times (1 + p^n\Z_p).
	\]
	The subgroup $p^{f\Z} \times \Z_p^\times$ is the norm subgroups for the unramified extension
	of degree $f$, which is $\Q_p(\zeta_{p^f-1})$.
	The group $p^\Z \times (1_p^n \Z_p)$ is the norm subgroup of $\Q_p(\zeta_{p^n})$.
	Hence $l$ is contained in $\Q_p(\zeta_{p^f-1}, \zeta_{p^n})$.
\end{proof}

\begin{theorem} \label{thm:Kronecker Weber}
	\uses{lem:local cyclotomic norms,
		lem:local image inertia,
		lem:subgroup compatibility}
	Let $l/\Q$ be a finite abelian extension.
	Then there exists a natural number $n$ such that $l$ is isomorphic to
	a subfield of $\Q(\zeta_n)$.
\end{theorem}

\begin{proof}
	Let $S$ be a the set of primes which ramify in $l$.
	For each $p \in S$ we let $\hat p$ be a prime of $l$ above $p$.
	We therefore have an abelian extension $l_{\hat p} / \Q_p$.
	Choose $r_p$ such that $1+p^{r_p} \Z_p \subseteq N(l_{\hat p}^\times)$.
	Let $n = \prod_{p \in S} p^{r_p}$.
	Let $m = l(\zeta_n)$.
	We shall prove that $m = \Q(\zeta_n)$, which implies $l$ is
	isomorphic to a subfield of $\Q(\zeta_n)$.

	For a prime $p \in S$, let $D_p$ and $I_p$ be the decomposition subgroup and inertia subgroup of
	$\Gal(m/\Q)$ at $p$. We may identify $D_p$ with $\Gal(m_p / \Q_p)$, and we have a reciprocity
	isomorphism
	\[
		D_p \cong \Q_p^\times / N(m_p^\times).
	\]
	By \ref{lem:local image inertia} The image of $I_p$ under the reciprocity map is
	\[
		I_p \cong \Z_p^\times / N(m_p^\times) \cap \Z_p^\times.
	\]
	We have
	\[
		N_{m_p/\Q_p} (m_p^\times)
		=
		N_{l_p/\Q_p} (l_p^\times) \cap N_{\Q_p(\zeta_n) / \Q_p} (\Q_p(\zeta_n)^\times).
	\]
	Note that by \ref{lem:local cyclotomic norms}, \ref{lem:subgroup compatibility}
	and \ref{lem:local image inertia},
	\[
		N_{\Q_p(\zeta_n) / \Q_p} (\Q_p(\zeta_n)^\times) \cap \Z_p^\times =
		N_{\Q_p(\zeta_{p^{r_p}}) / \Q_p} (\Q_p(\zeta_{p^{r_p}})^\times) \cap \Z_p^\times =
		1+p^r \Z_p
		\supseteq N_{l_p/\Q_p} (l_p^\times).
	\]
	This implies $N_{m_p/\Q_p} (m_p^\times) \cap \Z_p^\times = 1+p^r \Z_p$.
	It follows that $I_p \cong \Z_p^\times / (1+p^{r_p} \Z_p) \cong (\Z / p^{r_p})^\times$.
	In particular $|I_p| = \phi(p^{r_p})$, where $\phi$ is the Euler totient function.

	Let $I$ be the subgroup generated by the $I_p$ for $p \in S$.
	The fixed field of $I$ is an unramified extension of $\Q$, and is therefore equal to $\Q$.
	Therefore $I = \Gal(m/\Q)$ and we have
	\[
		 [m : \Q] = |I| \le \prod |I_p| = \phi(n) = [\Q(\zeta_n) : \Q].
	\]
	Hence $m = \Q(\zeta_n)$.
\end{proof}
