% In this file you should put the actual content of the blueprint.
% It will be used both by the web and the print version.
% It should *not* include the \begin{document}
%
% If you want to split the blueprint content into several files then
% the current file can be a simple sequence of \input. Otherwise It
% can start with a \section or \chapter for instance.


\chapter{Group Cohomology}

\section{Generalities}

Let $G$ be a group.
By a $G$-module, we shall mean a module $M$ over the integral group ring $\Z[G]$, on which we
write scalars on the left. This is equivalent to giving a monoid homomorphism $G \to End_\Z M$.
The category of $G$-modules is in Mathlib as \texttt{Rep Int G}.

Given a $G$-module $M$, there is a cochain complex $C^n(G,M)$ of $\Z$-modules
indexed by $n \in \N$, which consists of the functions $G^n \to M$ with some appropriately defined
differentials.
The cochain complex $C^n(G,M)$ is functorial in $M$ and is defined in Mathlib as
\texttt{groupCohomology.cochainsFunctor}.
The cohomology groups of this chain complex are called the cohomology groups of the
$G$-module $M$, and are written $H^n(G,M)$. These are defined in Mathlib as
\texttt{groupCohomology M n}.

The next two lemmas are a little technical.

\begin{lemma}
  \label{lem:groupCohomology.exact1}
  \lean{groupCohomology.exact1}
  The functor taking $M$ to $C^\bullet (G,M)$ preserves finite limits.
\end{lemma}

\begin{lemma}
  \label{lem:groupCohomology.exact2}
  \lean{groupCohomology.exact2}
  The functor taking $M$ to $C^\bullet (G,M)$ preserves finite colimits.
\end{lemma}

\begin{lemma}
  \label{lem:cochainsFunctor exact}
  \lean{groupCohomology.cochainsFunctor_Exact}
  The functor taking $M$ to $C^\bullet (G,M)$ is exact.
  I.e. if $0 \to A \to B \to C \to 0$ be a short exact sequence of $G$-modules.
  Then the corresponding sequence of cochain complexes is exact:
  \[
    0 \to C^n(G,A) \to C^n(G,B) \to C^n(G,C) \to 0.
  \]
\end{lemma}

\begin{proof}
  \uses{lem:groupCohomology.exact1, lem:groupCohomology.exact2}
  This follows automatically from lemmas \ref{lem:groupCohomology.exact1}
  and \ref{lem:groupCohomology.exact2} (by \texttt{exact?}).
\end{proof}

\begin{definition}[Long exact sequences]
  \label{def: Long exact sequences}
  \lean{groupCohomology.δ}
  \uses{lem:groupCohomology.exact1, lem:groupCohomology.exact2}
  Given a short exact sequence $0 \to A \stackrel{f}\to B \stackrel{g}\to C \to 0$ of $G$-modules,
  the corresponding sequence of cochain complexes is exact:
  $0 \to C^n(G,A) \to C^n(G,B) \to C^n(G,C) \to 0$.
  This implies that there exist "connecting homomorphisms" $\delta : H^n(G,C) \to H^{n+1}(G,A)$,
  such that the following is a long exact sequence:
  \[
    0 \to H^0(G,A) \stackrel{f_*}\to H^0(G,B) \stackrel{g_*}\to H^0(G,C) \stackrel{\delta}\to
    H^1(G,A) \stackrel{f_*}\to H^1(G,B) \stackrel{g_*} \to H^1(G,C) \stackrel{\delta}\to \cdots.
  \]
\end{definition}






We shall regard $\Z$ as a $G$-module on which the action of $G$ is trivial.
By a \emph{projective resolution of $\Z$}, we shall mean an exact sequence of $G$-modules
\[
  \cdots \to P_2 \stackrel{d_1}\to P_1 \stackrel{d_0}\to P_0 \to \Z \to 0,
\]
in which each $P_i$ projective.
An example of such a resolution is the bar resolution,
which is constructed in Mathlib.
Given any projective resolution of $\Z$ and any $G$-module $M$, we may define a cochain
complex of additive groups $C^n(G,M) = Hom_{\Z[G]}(P_n,M)$. The coboundary maps
$\partial^{(n)} : C^n(G,M) \to C^{n+1}(G,M)$ are defined by $\partial^{(n)} f = f \circ d_n$.
Regardless of the resolution $P_\bullet$,
the cohomology groups $H^n(G,M)$ are isomorphic to the cohomology groups
of the cochain complex $C^\bullet(G,M)$. This isomorphism is already in Mathlib.

(say something about inflation and restriction).





\section{Cohomology of cyclic groups}

(transfer lean file on the resolution across)

Let $G$ be a finite cyclic group of order $n$. We shall write $\xi$ for a generator of $G$.
The element $N$ in the group ring $\Z[G]$ is defined to be the sum of the group elements.

There is a special projective resolution of $\Z$ in which all of the modules $P_n$ are $\Z[G]$:
\[
  \Z[G] \stackrel{1-\xi} \to \Z[G] \stackrel{N}\to \Z[G] \stackrel{1-\xi}
  \to \Z[G] \stackrel{N}\to \Z[G] \stackrel{1-\xi} \to \Z[G] \stackrel{\epsilon}\to \Z.
\]
Here the map $\epsilon : \Z[G] \to \Z$ is the \emph{augmentation map}, defined by
\[
  \epsilon \left(\sum_{g \in G} c_g \bullet g\right) = \sum_{g \in G} c_g.
\]
We shall call this resolution $P_n$, so the modules in the resulotion are all $P_n = \Z[G]$
and the maps $d_n : P_{n+1} \to P_n$ are given by
\[
  d_n(m) = \begin{cases}
    m \cdot (1-\xi) & \text{if $n$ is even,}\\
    m \cdot N & \text{if $n$ is odd.}
  \end{cases}
\]
Given a $\Z[G]$-module $M$, the cohomology groups of $M$ may be calculated by
taking the cohomology of the cochain complex $C^n(G,M) = Hom_{\Z[G]}(P_n,M)$.
We may identify each of the cochain groups $C^n(G,M)$ with $M$
(this is \texttt{Rep.leftRegularHomEquiv} in Mathlib).
With this identification, the coboundary maps $\partial^{(n)} : C^n(G,M) \to C^{n+1}(G,M)$
are given by
\[
  \partial^{(n)} (m) = \begin{cases}
    (1-\xi) \cdot m & \text{if $n$ is even,}\\
    N \cdot m & \text{if $n$ is odd.}
  \end{cases}
\]
Hence the cochcain complex $C^\bullet(G,M)$ looks like this:
\[
  0 \to M \stackrel{1-\xi}\to M \stackrel{N} \to M \to
    \stackrel{1-\xi}\to M \stackrel{N} \to M \to \cdots.
\]

\begin{lemma}
  The kernel of the map $\partial^{(even)}: M \to M$
  is $M^G$.
\end{lemma}

\begin{proof}
  An element $m$ is in the kernel iff $(1-\xi)m=0$.
  This is equivalent to $m=\xi m$. Since $\xi$ generates $G$, this is
  equivalent to $m$ being $G$-invariant.
\end{proof}

Hence for $n > 0$ we have
\[
  H^n(G,M) \cong \begin{cases}
    M^G / N\cdot M & \text{if $n$ is even,}\\
    M[N] / (1-\xi) \cdot M & \text{if $n$ is odd.}
  \end{cases}
\]

\begin{theorem}\label{cyclic group cohomology with values in Z}
  Let $\Z$ be the trivial $G$-module.
  Then $H^1(G,\Z)=0$ and $H^2(G,\Z) \cong \Z/n\Z$, where $n = |G|$.
\end{theorem}

\begin{proof}
  In the case that the module $M$ is $\Z$, the map $\partial^{(even)} : \Z \to \Z$ is zero
  and the map $\partial^{(odd)} : \Z\to \Z$ is multiplication by $n$.
  The result follows immediately from this.
\end{proof}


\section{Herbrand Quotents}

Let $A$ be an additive commutative group, and suppose we have two endomorphisms
$f,g : A \to A$ such that $f \circ g = g \circ f = 0$.
Then the kernel of $f$ contains the image of $g$ and the kernel of $g$ contains the image of $f$,
and we may define the Herbrand quotient $q_{f,g} \in \Q$ by
\[
  q_{f,g} = \frac{| \ker f / \image g|}{| \ker g / \image f|}.
\]
(If either the numerator or denominator is infinite then $q_{f,g}$ takes the default value $0$.)

An example of this situation is where $M$ is a module for a finite cyclic group $G$.
The maps $f,g : M \to M$ are defined to be $\partial^{(even)} = 1-\xi$ and $\partial^{(odd)} = N$
respectively.
In this case we write
\[
  h(G,M) = q_{1-\xi,N},
\]
and we have
\[
  h(G,M) = \frac{|H^2(G,M)|}{|H^1(G,M)|}.
\]

\begin{theorem}
  \label{Herbrand of short exact sequence}
  Suppose we have a commutative diagram with exact rows:
  \[
    \begin{matrix}
      0 &\to& A &\to& B &\to& C &\to& 0 \\
      &&\downarrow f_A &&\downarrow f_B &&\downarrow f_C \\
      0 &\to& A &\to& B &\to& C &\to& 0 \\
      &&\downarrow g_A &&\downarrow g_B &&\downarrow g_C \\
      0 &\to& A &\to& B &\to& C &\to& 0 \\
    \end{matrix}
  \]
  Suppose that the pairs $f_*,g_*$ satisfy compose to zero in either direction
  for $*=A,B,C$, and thus have Herbrand quotients.
  Assume that at least two of $q(A)$, $q(B)$ and $q(C)$ are non-zero.
  Then all are non-zero and we have
  \[
    q(B) = q(A) q(C).
  \]
  Here we are using the notation $q(*) = q_{f_*,g_*}$.
\end{theorem}


In the special case that $M$ is a module over a cyclic group, the theorem gives:

\begin{corollary}
  Suppose $G$ is a finite cyclic group and we have a short exact sequence of $G$-modules
  \[
    0 \to A \to B \to C \to 0.
  \]
  Then $h(G,B) = h(G,A) h(G,C)$.
\end{corollary}

\begin{theorem}
  \label{Herbrand of finite}
  If $A$ is finite then $q_{f,g} = 1$.
\end{theorem}

\begin{proof}
  By the first isomorphism theorem $|\image f| = \frac{|A|}{|\ker f|}$, and similarly with $g$.
  Substituting this into the definition we have
  \[
    q_{f,g} = \frac{|\ker f| / (|A| / |\ker g|)}{|\ker g| / (|A| / |\ker f|)}
    = 1.
  \]
\end{proof}

\begin{lemma}
  Let $G$ be a cyclic group of order $n$ and let $\Z$ be the trivial $G$-module.
  Then we have
  \[
    h(G,\Z) = n.
  \]
\end{lemma}

\begin{proof}
  We have calculated both cohomology groups in
  Theorem \ref{cyclic group cohomology with values in Z}.
\end{proof}


\section{Splitting modules}

In this section $G$ is a group and $M$ is a $G$-module.
We suppose that we have a 2-cocycle $\sigma \in Z^2(G,M)$.
From such a $\sigma$ we shall construct a $G$-module $S$, called the \emph{splitting module} of
$\sigma$.
We shall show that there is an exact sequence of $G$-modules
\[
  0 \to M \to S \to \Z[G] \to \Z \stackrel{\epsilon}\to 0.
\]
The image of $\sigma$ in $H^2(G,S)$ is $0$.

(fill in the definition, transfer lean file across.)


\section{Tate's Theorem}

If $M$ satisfies certain conditions, then Tate has proved that $H^n(G,S)=0$ for all $n>0$,
and more generally $H^n_{Tate}(G,S)=0$ for all $n \in \Z$.
If this is the case then we see that $M$ is a dimension-shift of $\Z$, so that we have
isomorphisms for all $n \in \Z$:
\[
  H^n_{Tate}(G,\Z) \cong H^{n+2}(G,M).
\]

(state and prove the theorem. Maybe prove it with weaker hypotheses in the case $n=-2$.)


\newpage
\section{}



In what follows, $G$ will be a group whose operation we shall write multiplicatively
and $R$ will be a commutative ring.
We shall write $G^{ab}$ for the abelianization of $G$, i.e. its quotient by the commutator subgroup.
A representation of $G$ over $R$ is an $R$-module $M$ with an action of $G$ by $R$-linear maps.
For elements $g \in G$ and $m \in M$ we shall write $g \bullet m$ for the action of $g$ on $m$.

We give a proof of the following theorem of Tate.

\begin{theorem}
	Assume that $R$ has no additive torsion and $G$ is finite.
	Let $M$ be a representation of $G$ over $R$ and $\sigma \in H^2(G,M)$ with the following properties for all subgroups $H$ of $G$:
	\begin{itemize}
		\item
		$H^1(H,M)=0$.
		\item
		$H^2(H,M) \cong R / |H| R$ and is generated by the restriction of $\sigma$.
	\end{itemize}
	Then there is an isomorphism (depending on $\sigma$)
	\[
		G^{ab}
		\cong
		M^G / N_G M.
	\]
	(notation will be introduced below).
\end{theorem}

The hypotheses of the theorem are satisfies (with $R=\Z$) where $G$ is the Galois group of
a finite Galois extension of local or global fields $l/k$.
In the local case the module $M$ is the multiplicative group of $l$.
In the global case $M$ is the idele class group of $l$.
The isomorphisms of the theorem are the local and global ``reciprocity isomorphisms''.
For example in the local case we have:
\[
	Gal(l/k)^{ab}
	\cong
	k^\times / N_{l/k}l^\times.
\]









\section{Tate Cohomology}

Let $G$ be a finite group and $M$ a representation of $G$ over a commutative ring $M$.
There is a canonical linear map $N_G : M \to M$ defined by
\[
	N_G(m) = \sum_{x \in G} g \bullet m.
\]
The image of $N_G$ is contained in the submodule $M^G$ of $G$-invariant elements.
The kernel of $N_G$ contains the elements $g \bullet m - m$ of $M$.
It follows that $N_G$ induces a map $M_G \to M^G$, where $M_G$ is the module of coinvariants
(i.e. the largest quotient on which $G$ acts trivially; this is the quotient of $M$ by the
submodule generated by the elements $g \bullet m - m$).
We have a cochain complex $C^n(G,M)$ whose cohomology is $H^n(G,M)$.
We also have a chain complex $C_n(G,M)$ whose homology is $H_n(G,M)$.
The terms $C^0(G,M)$ and $C_0(G,M)$ may both be identified with $M$.
Gluing the chain complex and the cochain complex together with the map $N_G : M \to M$, we obtain
a cochain complex indexed by $\Z$:
\[
	\cdots \to C_2(G,M) \to C_1(G,M) \to M \to M \to C^1(G,M) \to C^2(G,M) \to \cdots
\]
We shall write $C^n_{Tate}$ for this cochain, and we normalize the indices so that for
natural numbers $n$ we have $C^n_{Tate}(G,M) = C^n(G,M)$. This implies
$C^{-n-1}_{Tate}(G,M) = C_n(G,M)$.


\begin{lemma}
  \lean{groupCohomology.TateComplexFunctor,
    groupCohomology.TateComplexFunctor_preservesFiniteLimits,
    groupCohomology.TateComplexFunctor_preservesFiniteColimits}
  $C^\bullet_{Tate}$ is an exact functor from $Rep(R,G)$ to the category
  of cochain complexes of $R$-modules.
\end{lemma}

We shall write $H^n_{Tate}(G,M)$ for the $n$-th cohomology of $C^n_{Tate}(G,M)$.
By the lemma, every short exact sequence of representations gives rise to a long exact sequence
of Tate cohomology groups.

Our choice of indexing implies the following:

\begin{lemma}
  \lean{groupCohomology.TateCohomology.iso_groupCohomology,
    groupCohomology.TateCohomology.iso_groupHomology}
	For all natural numbers $n$ we have
	\[
		H^{n+1}_{Tate}(G,M) \cong H^{n+1} (G,M), \qquad
		H^{-n-2}_{Tate}(G,M) \cong H_{n-1} (G,M).
	\]
\end{lemma}

The lemma leaves out the groups $H^0_{Tate}$ and $H^{-1}_{Tate}$, which are described by the next
results

\begin{lemma}
	\lean{groupCohomology.TateCohomology_zero_iso,
		groupCohomology.TateCohomology_zero_iso_of_isTrivial}
	$H^0_{Tate}(G,M) \cong M^G / N_G(M)$.
	In particular if $M$ is a trivial representation of $G$ then
	$H^0_{Tate}(G,M) \cong M / |G|M$.
\end{lemma}

\begin{lemma}
	\lean{groupCohomology.TateCohomology_neg_one_iso,
		groupCohomology.TateCohomology_neg_one_iso_of_isTrivial}
	$H^{-1}_{Tate}(G,M) \cong \ker (N_G : M \to M ) /
	\langle {m - g \bullet m : m \in M, g \in G}\rangle$.
	In particular if $M$ is a trivial representation of $G$ then
	$H^{-1}_{Tate}(G,M) \cong M[|G|]$.
\end{lemma}

We also note the following, which is a current PR (stated for group homology):

\begin{lemma}
	There is a canonical isomorphism $H^{-2}_{Tate}(G,\Z) \cong G^{ab}$.
\end{lemma}


\section{Coinduced and induced representations}

\begin{definition}
	\lean{
		Representation.coind₁,
		Rep.coind₁_obj,
		Rep.coind₁
	}
	Let $G$ be a group and $R$ a commutative ring.
	For an $R$-module $A$, there is an representation of $G$ over $R$
	on the space of all functions $f : G \to A$. The action of an element $g \in G$ on $f$
	is defined by
	\[
		(g \bullet f) (x) = f(xg).
	\]
	This representation is called the coinduced representation and is denoted $\coind_1(G,A)$.
	In fact $\coind_1(G,-)$ is a functor from the category of $R$-modules to the category of
	representations
	of $G$ over $R$.
\end{definition}

\begin{lemma}
	\lean{Rep.coind₁_isAcyclic}
	The representation $\coind_1(G,A)$ is acyclic. This means that
	for any subgroup $H$ of $G$, the cohomology groups $H^{n+1}(H,\coind_1(G,A))$ are
	all zero.
\end{lemma}

\begin{lemma}
	\lean{Rep.coind₁_quotientToInvariants_iso}
	Let $H$ be a normal subgroup of $G$. Then $\coind_1(G,A)^H \cong \coind_1(G/H,A)$.
\end{lemma}

\begin{corollary}
	\lean{Rep.coind₁_quotientToInvariants_isAcyclic}
	Let $H$ be a normal subgroup of $G$ and let $M^H$ be the representation of $G/H$ on the
	$H$-invariant vectors in $M$. Then $\coind_1(G,M)^H$ is acyclic as a representation of $G/H$.
\end{corollary}

\begin{definition}
	\lean{Rep.ind₁}
	Let $G$ be a group and $R$ a commutative ring.
	For an $R$-module $A$, there is an representation of $G$ over $R$
	on the space of all finitely supported functions $f : G \to A$.
	The action of an element $g \in G$ on $f$ is defined by
	\[
		(g \bullet f) (x) = f(g^{-1}x).
	\]
	This representation is called the induced representation and is denoted $\ind_1(G,A)$.
	In fact $\ind_1(G,-)$ is a functor from the category of $R$-modules to the category of
	representations	of $G$ over $R$.
\end{definition}

\begin{lemma}
	\lean{Rep.ind₁_isHomologyAcyclic}
	The representation $\ind_1(G,A)$ is homology-acyclic. This means that
	for any subgroup $H$ of $G$, the homology groups $H_{n+1}(H,\ind_1(G,A))$ are
	all zero.
\end{lemma}

\begin{definition}
	\lean{
		Representation.ind₁_toCoind₁,
		Representation.ind₁_toCoind₁_comm,
		Representation.ind₁_equiv_coind₁,
		Rep.ind₁_toCoind₁,
		Rep.instIsIsoAppModuleCatInd₁_toCoind₁OfFinite,
		Rep.ind₁_iso_coind₁}
	There is a morphism of representations $\ind_1(G,A) \to \coind_1(G,A)$,
	which takes a finitely supported function $f : G \to_0 A$ to the function
	\[
		x \mapsto f(x^{-1}).
	\]
	This map is an isomorphism of representations if the group $G$ is finite.
\end{definition}

\begin{corollary}
	\lean{Rep.ind₁_isAcyclic,
		Rep.coind₁_isHomologyAcyclic}
	If the group $G$ is finite then $\coind_1(G,A)$ is homology-acyclic
	and $\ind_1(G,A)$ is acyclic.
\end{corollary}




\section{Dimension-shifting}

\subsection{Shifting $\up$}

\begin{definition}
	\lean{Representation.coind₁',
		Rep.coind₁'}
	Let $G$ be a group and $M$ a representation of $G$ over a commutative ring $R$.
	There is a representation $\coind_1' (M)$ on the $R$-module of
	functions $G \to M$.
	The action of an element $g \in G$ on a function $f : G \to M$ is given by
	\[
		(g \bullet f)(x) = g \bullet (f (xg)).
	\]
\end{definition}

\begin{lemma}
	\lean{Rep.coind₁'_obj_iso_coind₁}
	The representations $\coind_1'(M)$ and $\coind_1(G,A)$ of $G$ are isomorphic.
\end{lemma}

\begin{corollary}
	\lean{Rep.coind₁'_isAcyclic}
	The representation $\coind_1'(M)$ is acyclic.
\end{corollary}

\begin{corollary}
	\lean{Rep.coind₁'_quotientToInvariants_isAcyclic}
	Let $H$ be a normal subgroup of $G$. Then $\coind_1'(M)^H$ is an acyclic representation of $G/H$.
\end{corollary}

\begin{definition}
	\lean{Representation.coind₁'_ι,
		Rep.coind₁'_ι,
		Rep.dimensionShift.instMonoAppCoind₁'_ι,
		Rep.dimensionShift.up,
		Rep.dimensionShift.upSes,
		Rep.dimensionShift.up_shortExact,
		Rep.dimensionShift.up_shortExact_res,
		Rep.dimensionShift.up_δ_zero_epi,
		Rep.dimensionShift.up_δ_isIso,
		Rep.dimensionShift.up_δiso,
		Rep.dimensionShift.up_δiso_natTrans,
		Rep.dimensionShift.up_δ_zero_epi_res,
		Rep.dimensionShift.up_δ_isIso_res,
		Rep.dimensionShift.up_δiso_res}
	There is an injection $M \hookrightarrow \coind_1'(M)$ which takes a vector $m \in M$
	to the constant function on $G$ with value $m$, and we define $\up(M)$ to be the cokernel of this map.
	We therefore have a short exact sequence of representations:
	\[
		0 \to M \to \coind_1'(M) \to \up(M) \to 0.
	\]
	By the lemma, we have for any subgroup $H$ of $G$ and any $n \in \N$ an isomorphism:
	\[
		H^{n+1}(H,\up(M)) \cong H^{n+2}(H,M).
	\]
	It is convenient to define $\coind_1'$ and $\up$ as functors, and the isomorphism
	above as an isomorphism of functors.
\end{definition}



\subsection{Shifting $\down$}
Let $G$ be a group and $M$ a representation of $G$ over a commutative ring $R$.

\begin{definition}
	\lean{Representation.ind₁',
		Rep.ind₁'}
	There is a representation $\ind_1' (M)$ on the $R$-module of finitely supported
	functions $G \to_0 M$. The action of an element $g \in G$ on a function $f : G \to_0 M$ is given by
	\[
		(g \bullet f)(x) = g \bullet (f (g^{-1}x)).
	\]
	The map $\ind_1'$ is functorial in $M$.
\end{definition}


\begin{lemma}
	\lean{
		Representation.ind₁'_lequiv,
		Representation.ind₁'_lequiv_comm,
		Representation.ind₁_map_comm,
		Rep.ind₁'_obj_iso,
		Rep.ind₁'_iso_forget₂_ggg_ind₁,
	}
	The representations $\ind_1'(M)$ and $\ind_1(G,M)$ are isomorphic; more precisely the
	functors $\ind_1'$ and $\ind_1(G,-)$ are isomorphic.
\end{lemma}

\begin{corollary}
	\lean{Rep.ind₁'_isHomologyAcyclic}
	The representation $\ind_1'(M)$ is homology-acyclic. This means that
	for any subgroup $H$ of $G$, the cohomology groups $H_{n+1}(H,\coind_1'(M))$ are
	all zero.
\end{corollary}

\begin{corollary}
	\lean{Rep.ind₁'_iso_coind₁',
		Rep.ind₁'_isAcyclic,
		Rep.coind₁'_isHomologyAcyclic}
	If the group $G$ is finite then $\ind_1'(M) \cong \coind_1'(M)$.
	In particular $\coind_1'(M)$ is homology-acyclic and $\ind_1'(M)$ is acyclic.
\end{corollary}

\begin{definition}
	\lean{Representation.ind₁'_π,
		Representation.ind₁'_π_comm,
		Rep.ind₁'_π,
		Rep.dimensionShift.down,
		Rep.dimensionShift.down_ses,
		Rep.dimensionShift.down_shortExact,
		Rep.dimensionShift.down_shortExact_res,
		Rep.dimensionShift.down_δ_zero_epi,
		Rep.dimensionShift.down_δ_zero_res_epi,
		Rep.dimensionShift.down_δ_isIso,
		Rep.dimensionShift.down_δiso,
		Rep.dimensionShift.down_δiso_natTrans,
		Rep.dimensionShift.down_δ_res_isIso,
		Rep.dimensionShift.down_δiso_res
	}
	There is an surjection $\ind_1'(M) \to M$ which takes a finitely supported
	function $f : G \to_0 M$ to the sum $\sum_{x \in G} f (x)$.
	We define $\down(M)$ to be the kernel of this map.
	We therefore have a short exact sequence of representations.
	\[
		0 \to \down(M) \to \ind_1'(M) \to M \to 0.
	\]
	By the lemma, we have for any subgroup $H$ of $G$ and any $n \in \N$ an isomorphism:
	\[
		H_{n+1}(H,\down(M)) \cong H_{n+2}(H,M).
	\]
	It is convenient to define $\ind_1'$ and $\down$ as functors, and the isomorphism
	above as an isomorphism of functors.
\end{definition}


\begin{lemma}
	\lean{groupCohomology.TateCohomology_coind₁,
		groupCohomology.TateCohomology_ind₁'}
	If $M$ is a representation of a finite group $G$ then the representations
	$\ind_1'(M)$ and $\coind_1'(M)$ are ``Tate-acyclic''. This means that for all
	subgroups $H$ of $G$ and all integers $n$, we have
	$H^n_{Tate}(H,\coind_1'(M)) = 0$ and $H^n_{Tate}(H,\ind_1'(M)) = 0$.
\end{lemma}

\begin{proof}
	By what we've already proved, it's sufficient to prove this in the cases $n = 0$ and $n = -1$.
	These cases can be done by hand.
\end{proof}


% \subsection{Finite groups}

% Suppose now that the group $G$ is finite.
% In this case, there is an isomorphism or representations $\ind_1'(M) \cong \coind_1'(M)$ which takes $f : G \to_0 M$ to the function
% \[
% 	x \mapsto f(x^{-1}).
% \]
% As a consequence, the representations $\coind_1'(M)$ and $\ind_1'(M)$ are both
% acyclic and homology-acyclic.

% \begin{lemma}
% 	If $M$ is a representation of a finite group $G$ then the representations
% 	$\ind_1'(M)$ and $\coind_1'(M)$ are ``Tate-acyclic''. This means that for all
% 	subgroups $H$ of $G$ and all integers $n$, we have
% 	$H^n_{Tate}(H,\coind_1'(M)) = 0$ and $H^n_{Tate}(H,\ind_1'(M)) = 0$.
% \end{lemma}

% \begin{proof}
% 	By the remark above, it's sufficient to prove this in the cases $n = 0$ and $n = -1$.
% \end{proof}

\begin{corollary}
	\lean{groupCohomology.instIsIsoModuleCatδ,
		groupCohomology.instIsIsoModuleCatδ_1,
		groupCohomology.upδiso_Tate,
		groupCohomology.downδiso_Tate
	}
	If the group $G$ is finite then for every subgroup $H$ of $G$
	and every $n \in \Z$ we have isomorphisms
	\[
		H^n_{Tate}(H, \up(M)) \cong H^{n+1}_{Tate}(H,M),
		\qquad
		H^{n+1}_{Tate}(H, \down(M)) \cong H^{n}_{Tate}(H,M).
	\]
\end{corollary}





\section{The inflation-restriction sequence}


\begin{definition}
	\lean{groupCohomology.infl}
	Let $H$ be a normal subgroup of a group $G$ and $M$ is
	a representation of $G$ (over some commutative ring $R$).
	The subspace $M^H = \{m \in M | \forall h \in H, h \bullet m = 0\}$ is
	a representation of the quotient group $G / H$.
	Any n-chain $\sigma \in C^n(G/H,M^H)$ may be pulled back to an
	$n$-chain on $G$ with values in $n$. This defines a map of complexes
	\[
		C^\bullet(G/H, M^H) \to C^\bullet(G,H).
	\]
	The corresponding map $\infl : H^\bullet(G/H, M^H) \to H^\bullet(G,M)$
	is called the ``inflation map''.
\end{definition}


\begin{definition}
	\lean{groupCohomology.rest}
	The restriction of an $n$-cochain $\sigma\in C^n(G,M)$ to a subgroup $H$
	is an $n$-cochain on $H$. Restriction of cochains gives a map of complexes
	\[
		C^\bullet(G,M) \to C^\bullet(H,M).
	\]
	The corresponding map $\rest : H^\bullet(G,M) \to H^\bullet(H,M)$ is called the
	``restriction map''.
\end{definition}

\begin{theorem}
	\lean{groupCohomology.inflationRestriction,
		groupCohomology.inflation_restriction_mono,
		groupCohomology.inflation_restriction_exact}
	Assume that for all natural numbers $i < n$ we have $H^{i+1}(H,M)=0$.
	Then the following sequence is exact:
	\[
		0 \to H^{n+1}(G/H, M^H) \to H^{n+1}(G,M) \to H^{n+1}(H,M),
	\]
	where the first map is inflation and the second is restriction.
\end{theorem}

\begin{proof}
	This is already in Mathlib for $n=0$, i.e. for cohomology in
	dimension $1$.
	We prove it in general by induction on $n$ using the dimension-shifting function $\up$.
	Recall that we have a short exact sequence of representations of $G$:
	\[
		0 \to M \to \coind_1'(M) \to \up(M) \to 0.
	\]
	By assumption $H^1(H,M)=0$, so by taking $H$-invariants we obtain a short exact sequence of $G/H$-modules:
	\[
		0 \to M^H \to \coind_1'(M)^H \to \up(M)^H \to 0.
	\]
	Corresponding to this short exact sequence we have a long exact sequence in cohomology
	containing the following section
	\[
		 0 \to H^n(G/H, \up(M)^H) \to  H^{n+1}(G/H, M^H) \to 0
	\]
	We have a diagram where the horizontal maps are inflation and restriction maps and the vertical
	maps are isomorphisms.
	\[
		\begin{matrix}
			0 &\to& H^{n}(G/H, \up(M)^H) &\to &H^{n}(G,\up(M)) & \to & H^n(H,\up(M)) \\
			  &   &   \downarrow              &    &  \downarrow         &     &  \downarrow  \\
			0 &\to& H^{n+1}(G/H, M^H) &\to &H^{n+1}(G,M) & \to & H^{n+1}(H,M).
		\end{matrix}
	\]
	The top row is exact by the inductive hypothesis.
	We must show that the second row is exact; this amounts to showing that the diagram commutes.
	This follows from the next two lemmas.
\end{proof}

\begin{lemma}
	\lean{groupCohomology.rest_δ_naturality}
	Suppose we have a a short exact sequence of representations of $G$
	\[
			0 \to  A \to  B \to  C  \to  0.
	\]
	For every subgroup $H$ of $G$ the following square commutes:
	\[
		\begin{matrix}
			H^{n}(G,C) & \to & H^{n+1}(G,A)\\
			\downarrow & & \downarrow \\
			H^n(H,C) & \to &H^{n+1}(H,A)
		\end{matrix}.
	\]
	The vertical maps are restriction maps and the horizontal maps are the connecting homomorphisms
	from the long exact sequence.
\end{lemma}

\begin{lemma}
	\lean{groupCohomology.infl_δ_naturality}
	Let $H$ be a normal subgroup of $G$, and suppose we have a short exact
	sequence of $G$-modules:
	\[
			0 \to  A \to  B \to  C  \to  0.
	\]
	Assume also that the following is a short exact sequence of $G/H$-modules:
	\[
			0 \to  A^H \to  B^H \to  C^H  \to  0.
	\]
	Then for all $n \in \N$ the following square commutes
	\[
		\begin{matrix}
			H^{n}(G/H,C^H) & \to & H^{n+1}(G/H,A^H)\\
			\downarrow & & \downarrow \\
			H^n(G,C) & \to & H^{n+1}(G,A)
		\end{matrix}.
	\]
	The vertical maps are inflation and the horizontal maps are the connecting homomorphisms
	from the long exact sequences.
\end{lemma}


\section{Periodicity for finite cyclic groups}

Suppose now that $G$ is a finite cyclic group of order $n$.
We shall write $g$ for a fixed generator of $G$.
Let $M$ be a representation of $G$.


\begin{definition}
	\lean{Representation.map₁}
	There is a map $\map_1 : \coind_1'(M) \to \coind_1'(M)$ which takes $f : G \to M$ to the function
	\[
		x \mapsto f(x) - f(g^{-1}x).
	\]
\end{definition}


\begin{lemma}
	\lean{Representation.map₁_ker}
	The kernel of $\map_1$ consists of the constant functions $G \to M$, i.e. the image of the
	map $M \to \coind_1'(M)$.
\end{lemma}

\begin{corollary}
	The image of $\map_1$ is isomorphic to $\up(M)$.
\end{corollary}

Recall that since $G$ is finite, the representations $\coind_1'(M)$ and $\ind_1'(M)$
are isomorphic, and we define $\map_2$ to be the corresponding map $\ind_1'(M) \to \ind_1'(M)$.
This is given by
\[
	\map_2(f) (x) = f(x) - f(xg^{-1}).
\]

\begin{lemma}
	\lean{Representation.map₂_range}
	The image of $\map_2 : \ind_1'(M) \to \ind_1'(M)$ is precisely the set of functions $G \to M$
	which sum to zero. This is the kernel of the map $\ind_1'(M) \to M$.
\end{lemma}




The two lemmas show that we have a diagram with exact rows and vertical isomorphisms:
\[
	\begin{matrix}
		0 \to M \to &\coind_1'(M)& \stackrel{\map_1}\to& \coind_1'(M)\\
		& || &&|| \\
		& \ind_1'(M)& \stackrel{\map_2}\to& \ind_1'(M) &\to M \to 0
	\end{matrix},
\]


\begin{corollary}
	\lean{Rep.up_iso_down}
	In particular we have an isomorphism:
	\[
		\up(M) \cong \down(M).
	\]
	(It is more convenient in the long run to express this as an isomorphism of functors
	$\up \cong \down$.)
\end{corollary}

\begin{corollary}
	\lean{Rep.periodicCohomology}
	For all $n \in \N$, $H^{n+1}(G,M) \cong H^{n+3}(G,M)$.
\end{corollary}







\section{The Acyclic Criterion}

Recall that a representation $M$ of a group $G$ is \emph{acyclic} if for all subgroups $H$ of $G$
and all $n \in \N$, the cohomology groups $H^{n+1}(H,M)$ are zero.

\begin{theorem}
	\lean{groupCohomology.Acyclic_of_even_of_odd_of_solvable}
	Let $M$ be a representation of a finite solvable group $G$.
	Suppose we have positive natural numbers $e$ and $o$ with $e$ even and $o$ odd, such that for all subgroups $H$ of $G$ we have
	\[
		H^e(H,M) = 0, \qquad H^o(H,M) = 0.
	\]
	Then $M$ is acyclic.
\end{theorem}

\begin{proof}
	We must prove that $H^{n+1}(H,M) = 0$ for all $H$ and all $n$.
	We'll prove this by induction on $H$. The result is true for the trivial subgroup of $G$.
	Assume that the result is true for $H$, and assume that $H' / H$ is cyclic.
	The inductive hypothesis implies that (for al $n$) the inflation restriction sequence is exact:
	\[
		0 \to H^{n + 1} (H'/H, M^H) \to H^{n+1}(H' , M) \to H^{n+1}(H,M)= 0.
	\]
	We therefore have isomorphisms $H^{n + 1} (H'/H, M^H) \cong H^{n+1}(H' , M)$.
	In particular we have $H^{e} (H'/H, M^H) = 0$ and $H^{o} (H'/H, M^H) = 0$.
	Using periodicity of the cohomology of a cyclic group, we have $H^{n+1}(H'/H,M^H)=0$ for all $n$.
\end{proof}


\begin{theorem}
	\lean{groupCohomology.Acyclic_of_even_of_odd}
	Let $M$ be a representation of a finite group $G$ (no longer assumed to be solvable).
	Suppose we have positive natural numbers $e$ and $o$ with $e$ even and $o$ odd, such that for all subgroups $H$ of $G$ we have
	\[
		H^e(H,M) =0, \qquad H^o(H,M) = 0.
	\]
	Then $M$ is acyclic.
\end{theorem}

\begin{proof}
	(Requires definition of corestriction, which is not yet in Mathlib).
	Let $H$ be a subgroup of $G$.
	Fix a prime number $p$ and let $S_p$ be the Sylow $p$-subgroup of $H$.
	Consider the composition of the restriction and corestriction maps
	\[
		H^{n+1}(H,M) \to H^{n+1}(S_p,M) \to H^{n+1}(H,M).
	\]
	This composition is multiplication by the index $[H:S_p]$,
	and is therefore injective on the $p$-torsion
	in $H^{n+1}(H,M)$.
	However, the previous result implies (since $S_p$ is solvable) that $H^{n+1}(S_p,M)=0$.
	Therefore $H^{n+1}(G,M)$ has zero $p$-torsion.
	The same composition with $S_p$ replaced by the trivial subgroup implies that every element
	of $H^{n+1}(H,M)$ is killed by $|H|$.
	Therefore $H^{n+1}(H,M) = 0$.
\end{proof}


\begin{corollary}
	\lean{Rep.dimensionShift.up_isAcyclic,
		Rep.dimensionShift.down_isAcyclic}
	If $M$ is an acyclic representation of a finite group $G$
	then $\up(M)$ and $\down(M)$ are acyclic.
\end{corollary}

\begin{proof}
	This follows from the previous result, together with the dimension shifting isomorphisms.
\end{proof}

\begin{theorem}
	\lean{groupCohomology.TateCohomology_of_isAcyclic,
		Rep.isHomologyAcyclic_of_isAcyclic}
	Let $G$ be an acyclic representation of a finite group $G$.
	Then for all integers $n$ and all subgroups $H$ of $G$ we have $H^n_{Tate}(H,M)=0$.
	In particular $M$ is homology-acyclic.
\end{theorem}

\begin{proof}
	Fix an integer $n$ and choose a natural number $m$ such that $m + n > 0$.
	By the previous lemma, $\down^m(M)$ is acyclic.
	Therefore
	\[
		H^n_{Tate}(H,M) \cong H^{n+m}(H, \down^m(M)) \cong 0.
	\]
\end{proof}



\section{The augmentation module $\aug(R,G)$}

Let $G$ be a group and $R$ a commutative ring. We shall also write $R$ for the trivial
representation of $G$ on $R$.
The left regular representation of $G$ is the representation $\ind_1'(R)$, whose
vectors consist of finitely supported functions $f : G \to_0 R$.
There is a surjective morphism $\leftRegular(R,G) \to R$ which takes $f$ to $\sum_{x \in G} f(x)$.
The augmentation module $\aug(R,G)$ is defined to be the kernel of this map.
We therefore have a short exact sequence
\[
	0 \to \aug(R,M) \to \leftRegular(R,G) \to R \to 0.
\]
If we assume that $G$ is finite, then we have shown above that $\leftRegular(R,G)$ is acyclic.
In particular we have isomorphisms for all $n \in \Z$ and all subgroups $H$ of $G$:
\[
	H^n_{Tate}(H,R) \cong H^{n+1}_{Tate}(H,\aug(R,G)).
\]


\begin{lemma}
	Let $G$ be a finite group.
	Then for every subgroup $H$ of $G$ we have an isomorphism $H^1(H,\aug(R,G)) = R / |H| R$.
\end{lemma}

\begin{proof}
	Since $R$ is a trivial $H$-module, we have $H^0_{Tate}(H,R) \cong R / |H| R$.
\end{proof}


\begin{lemma}
	Let $G$ be a finite group and assume that $R$ has no additive torsion.
	Then for all subgroups $H$ of $G$ we have $H^2(H,\aug(R,G)) = 0$.
\end{lemma}

\begin{proof}
	Since $R$ has no additive torsion we have
	$H^1(G,R) \cong \Hom(G,R) = 0$.
\end{proof}


\section{The splitting module}

In this section $G$ is a finite group; $M$ is a representation of $G$ over a commutative ring $R$
 and $\sigma \in H^2(G,M)$ is a cohomology class satisfying the following conditions for all
 subgroups $H$ of $G$:
\begin{itemize}
	\item
	$H^1(H,M)=0$.
	\item
	$H^2(H,M)$ isomorphic to $R / |H|R$, and is generated by the restriction $\sigma | H$.
\end{itemize}
We shall also assume that $R$ has no additive torsion. This implies
\[
	H^2(G,\aug(R,G)) \cong H^1(G,R) \cong \Hom(G,R) = 0.
\]


The two conditions together mean that $H^2(H,M)$ is isomorphic to $R/|H|R$.
We shall write $\sigma'$ for an inhomogeneous 2-cocycle representing $\sigma$.

\begin{definition}
	The splitting module of $\sigma'$ is the $R$-module $M \times \aug(R,G)$,
	with the action of an element $g \in G$ given by
	\[
		g \bullet (m,f)
		= \left(g \bullet m + \sum_{x \in G} f(x) \sigma'(g,x) , g \bullet f\right).
	\]
	(Although we don't need this fact right now, it's worth knowing that up to isomorphism, the splitting module depends only on the cohomology class $\sigma$. For this reason, we'll write
	$\Split(\sigma)$ for this representation).
\end{definition}



There is evidently a short exact sequence of representations of $G$.
\[
	0 \to M \to \Split(\sigma) \to \aug(R,G) \to 0.
\]

\begin{lemma}
	The image of $\sigma$ in $H^2(G,\Split(\sigma))$ is zero.
\end{lemma}

\begin{proof}

\end{proof}

\begin{theorem}
	Assume $R$ and $\sigma$ satisfy the conditions above.
	Then	$\Split(\sigma)$ is acyclic.
\end{theorem}

\begin{proof}
	By the acyclicity criterion, it's enough to prove for every subgroup $H$ of $g$ that
	$H^1(H,\Split(\sigma))=0$ and $H^2(H,\Split(\sigma))=0$.
	We have a long exact sequence with the following terms:
	\[
		0 \to H^1(H,\Split(\sigma)) \to H^1(H,\aug(R,G)) \to H^2(H,M) \to H^2(H,\Split(\sigma))
		\to 0.
	\]
	Since $\sigma|H$ generates $H^2(H,M)$, the previous lemma implies that the last map is zero,
	and in particular $H^2(H,\Split(\sigma))=0$ (this uses the fact that restriction is a natural
	transformation).
	The $R$-modules $H^1(H,\aug(R,G))$ and $H^2(H,M)$ are both isomorphic to $R / |H|R$,
	and the map from one to the other is surjective.
	Since every surjective $R$-module endomorphism of $R /|H|R$ is injective, the map
	from $H^1(H,\aug(R,G))$ to $H^2(H,M)$ is injective.
	Therefore $H^1(H,\Split(\sigma))=0$.
\end{proof}



The theorem implies that we have isomorphisms for all $n\in \Z$ (which depend of $\sigma$):
\[
	H^{n}_{Tate}(G,R) \cong H^{n+1}_{Tate}(G,\aug(R,G)) \cong H^{n+2}_{Tate}(G,M).
\]
In particular in the case $n = -2$, $R = \Z$ we have the (inverse of the) reciprocity isomorphism
\[
	G^{ab} \cong H^{-2}(G,\Z) \cong M^G / N_G M.
\]
